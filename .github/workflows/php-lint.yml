on: [push, pull_request]
name: Main
jobs:
  php-check:
    runs-on: ubuntu-latest
    steps:
      - name: checkout
        uses: actions/checkout@v2
      - name: phplint
        uses: overtrue/phplint@master
        with:
          path: .
          options: --exclude=system
      - name: php-var-dump-check
        uses: umutphp/php-var-dump-check-action@v1
        with:
          extensions: 'php'
      - uses: umutphp/php-magic-number-check-action@v1
      
  phpmetrics-action:
    runs-on: ubuntu-latest
    name: PhpMetrics Action
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: PhpMetrics Scan
        uses: umutphp/phpmetrics-action@v1
      - name: Upload HTML Report
        uses: actions/upload-artifact@v1
        with:
          name: HTML Report
          path: phpmetrics.html
      - name: Upload XML Report
        uses: actions/upload-artifact@v1
        with:
          name: HTML Report
          path: phpmetrics.xml
      - name: Upload Violations Report
        uses: actions/upload-artifact@v1
        with:
          name: HTML Report
          path: violations.xml